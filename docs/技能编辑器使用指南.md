# 技能编辑器使用指南

## 概述

技能编辑器是一个强大的工具，允许您创建自定义技能效果，包括伤害、治疗、增益、减益、控制状态和护盾等。

## 快速开始

### 1. 创建自定义技能

在 `config/plugins/` 目录下创建一个新的 JSON 文件，例如 `我的技能.json`：

```json
{
  "name": "我的自定义技能",
  "description": "这是我的第一个自定义技能",
  "enabled": true,
  "priority": 5,
  "cooldown": 3,
  "config": {
    "skill_type": "custom",
    "target_type": "single_enemy",
    "damage_type": "physical",
    "base_damage": 80,
    "effects": [
      {
        "effect_type": "damage",
        "value": 1.2,
        "is_percentage": true,
        "chance": 1.0
      }
    ]
  }
}
```

### 2. 技能配置参数

#### 基本参数
- `name`: 技能名称
- `description`: 技能描述
- `enabled`: 是否启用 (true/false)
- `priority`: 优先级 (数字越小优先级越高)
- `cooldown`: 冷却回合数

#### 技能类型配置
- `skill_type`: 必须设置为 "custom"
- `target_type`: 目标类型
  - `single_enemy`: 单个敌人
  - `all_enemies`: 所有敌人
  - `single_ally`: 单个友军
  - `all_allies`: 所有友军
  - `self`: 自己
- `damage_type`: 伤害类型
  - `physical`: 物理伤害
  - `magical`: 魔法伤害
  - `true`: 真实伤害
- `base_damage`: 基础伤害值

### 3. 效果类型

#### 伤害效果 (damage)
```json
{
  "effect_type": "damage",
  "value": 1.5,        // 伤害值或倍率
  "is_percentage": true, // 是否为百分比
  "chance": 0.8        // 触发概率 (0.0-1.0)
}
```

#### 治疗效果 (heal)
```json
{
  "effect_type": "heal",
  "value": 200,        // 治疗值
  "is_percentage": false, // 是否为百分比
  "chance": 1.0,
  "cleanse_effects": true // 是否净化负面效果
}
```

#### 增益效果 (buff)
```json
{
  "effect_type": "buff",
  "buff_type": "attack", // attack/defense/crit_rate/crit_damage/max_health
  "value": 0.3,          // 增益值
  "duration": 3,         // 持续回合
  "is_percentage": true, // 是否为百分比
  "target": "self",      // 目标 (self/single_ally/all_allies)
  "chance": 0.9
}
```

#### 减益效果 (debuff)
```json
{
  "effect_type": "debuff",
  "debuff_type": "defense", // attack/defense/crit_rate/crit_damage
  "value": 0.25,           // 减益值
  "duration": 2,           // 持续回合
  "is_percentage": true,   // 是否为百分比
  "target": "single_enemy", // 目标
  "chance": 0.7
}
```

#### 控制效果 (control)
```json
{
  "effect_type": "control",
  "control_type": "stun",   // stun/freeze/taunt/paralyze
  "duration": 1,           // 持续回合
  "target": "single_enemy", // 目标
  "chance": 0.4
}
```

#### 护盾效果 (shield)
```json
{
  "effect_type": "shield",
  "value": 150,           // 护盾值
  "duration": 2,          // 持续回合
  "target": "single_ally", // 目标
  "chance": 1.0
}
```

#### 状态效果 (status)
```json
{
  "effect_type": "status",
  "status_type": "burn",    // burn/poison
  "value": 50,             // 每回合伤害
  "duration": 3,           // 持续回合
  "target": "single_enemy", // 目标
  "chance": 0.6
}
```

### 4. 高级示例

#### 复合技能示例
```json
{
  "name": "烈焰风暴",
  "description": "造成魔法伤害并附加燃烧效果",
  "enabled": true,
  "priority": 4,
  "cooldown": 4,
  "config": {
    "skill_type": "custom",
    "target_type": "all_enemies",
    "damage_type": "magical",
    "base_damage": 60,
    "effects": [
      {
        "effect_type": "damage",
        "value": 0.8,
        "is_percentage": true,
        "chance": 1.0
      },
      {
        "effect_type": "status",
        "status_type": "burn",
        "value": 40,
        "duration": 2,
        "chance": 0.5
      }
    ]
  }
}
```

#### 辅助技能示例
```json
{
  "name": "神圣祝福",
  "description": "治疗友军并提升攻击力",
  "enabled": true,
  "priority": 3,
  "cooldown": 2,
  "config": {
    "skill_type": "custom",
    "target_type": "single_ally",
    "effects": [
      {
        "effect_type": "heal",
        "value": 180,
        "is_percentage": false,
        "cleanse_effects": true,
        "chance": 1.0
      },
      {
        "effect_type": "buff",
        "buff_type": "attack",
        "value": 0.15,
        "duration": 3,
        "is_percentage": true,
        "chance": 1.0
      }
    ]
  }
}
```

### 5. 使用技巧

1. **平衡性**: 注意技能的冷却时间、效果概率和数值平衡
2. **组合效果**: 可以组合多个效果创建复杂的技能
3. **目标选择**: 合理选择目标类型以达到最佳效果
4. **概率设置**: 高概率效果配合低数值，低概率效果配合高数值

### 6. 测试技能

创建技能后，运行战斗模拟器测试技能效果：

```bash
python main.py
```

查看战斗日志中技能效果的触发情况和数值计算。

## 故障排除

- 如果技能不生效，检查 JSON 格式是否正确
- 确保 `enabled` 设置为 true
- 检查文件路径是否正确 (`config/plugins/`)
- 查看控制台输出是否有错误信息

## 支持的效果类型

完整的效果类型定义请参考 `config/plugins/技能编辑器.json` 文件。